<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign2Talk - Treinamento e Tradu√ß√£o de Libras</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/mobilenet@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/knn-classifier@latest"></script>
    <style>
        /* CSS COMPLETO DA ESTRUTURA ORIGINAL */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); overflow: hidden; }
        header { background: linear-gradient(135deg, #2c3e50, #34495e); color: white; padding: 30px; text-align: center; }
        h1 { font-size: 2.5em; margin-bottom: 10px; }
        .subtitle { font-size: 1.2em; opacity: 0.9; }
        .upload-section { background: #e8f5e8; padding: 20px; margin: 20px; border-radius: 10px; border: 2px dashed #27ae60; }
        .upload-area { border: 2px dashed #3498db; border-radius: 10px; padding: 30px; text-align: center; background: #f8f9fa; margin: 15px 0; cursor: pointer; transition: all 0.3s ease; }
        .upload-area:hover { background: #e3f2fd; border-color: #2980b9; }
        .upload-area.dragover { background: #d4edda; border-color: #27ae60; }
        .upload-icon { font-size: 48px; margin-bottom: 15px; }
        .file-input { display: none; }
        .upload-buttons { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 15px 0; }
        .btn-upload { background: #3498db; padding: 12px; border: none; border-radius: 8px; color: white; font-weight: bold; cursor: pointer; }
        .btn-upload:hover { background: #2980b9; }
        .btn-folder { background: #9b59b6; }
        .btn-folder:hover { background: #8e44ad; }
        .preview-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px; margin: 15px 0; max-height: 200px; overflow-y: auto; }
        .preview-item { position: relative; border: 2px solid #ddd; border-radius: 5px; overflow: hidden; }
        .preview-img { width: 100%; height: 80px; object-fit: cover; }
        .preview-label { position: absolute; bottom: 0; left: 0; right: 0; background: rgba(0,0,0,0.7); color: white; padding: 2px 5px; font-size: 10px; text-align: center; }
        .remove-btn { position: absolute; top: 2px; right: 2px; background: #e74c3c; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; font-size: 12px; cursor: pointer; }
        .batch-training { background: #fff3cd; padding: 15px; border-radius: 10px; margin: 15px 0; border: 1px solid #ffeaa7; }
        .training-progress { margin: 10px 0; }
        .progress-bar { width: 100%; height: 20px; background: #ecf0f1; border-radius: 10px; overflow: hidden; }
        .progress-fill { height: 100%; background: #27ae60; transition: width 0.3s ease; }
        .progress-text { text-align: center; margin-top: 5px; font-size: 12px; }
        .cameras-container { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; padding: 20px; }
        .camera-box { background: #f8f9fa; padding: 15px; border-radius: 10px; text-align: center; }
        .webcam-view { width: 100%; max-width: 400px; height: 300px; border: 3px solid #34495e; border-radius: 10px; background: #000; }
        .hand-canvas { width: 100%; max-width: 400px; height: 300px; border: 3px solid #27ae60; border-radius: 10px; background: #000; }
        .controls-section { padding: 20px; background: #ecf0f1; margin: 20px; border-radius: 10px; }
        .button-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; margin-bottom: 20px; }
        button { padding: 12px 15px; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; color: white; }
        button:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        .btn-webcam { background: #2ecc71; }
        .btn-train { background: #e74c3c; }
        .btn-recognize { background: #9b59b6; }
        .btn-stop { background: #95a5a6; }
        .btn-save { background: #f39c12; }
        .btn-clear { background: #e67e22; }
        .btn-load { background: #1abc9c; }
        .letters-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 8px; margin: 15px 0; }
        .btn-letter { background: #34495e; font-size: 12px; padding: 8px 5px; }
        .results-section { background: white; padding: 25px; border-radius: 10px; margin: 20px; border: 2px solid #3498db; display: flex; flex-direction: column; align-items: center; }
        .loading { display: inline-block; width: 20px; height: 20px; border: 3px solid #f3f3f3; border-top: 3px solid #3498db; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        /* Novos estilos para resultado do BD */
        #resultado { font-size: 3em; font-weight: bold; margin-bottom: 10px; }
        #imagemGesto { max-width: 100%; max-height: 250px; border-radius: 8px; margin-top: 20px; border: 3px solid #667eea; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ü§ü Reconhecedor de Libras - Treinamento</h1>
            <p class="subtitle">Treine com webcam OU carregue imagens existentes</p>
        </header>

        <div class="upload-section">
            <h3 class="section-title">üìÅ Upload de Imagens Existentes</h3>
            
            <div class="upload-area" id="uploadArea" ondragover="this.classList.add('dragover')" ondragleave="this.classList.remove('dragover')" ondrop="handleFileSelect(event)">
                <div class="upload-icon">üìÅ</div>
                <h4>Arraste e solte imagens aqui</h4>
                <p>ou clique para selecionar arquivos</p>
                <input type="file" id="fileInput" class="file-input" multiple accept="image/*" onchange="handleFileSelect(event)">
                <p style="font-size: 12px; color: #666; margin-top: 10px;">
                    Suporte: JPG, PNG, GIF ‚Ä¢ M√°x: 50 imagens
                </p>
            </div>
            
            <div class="upload-buttons">
                <button class="btn-upload" onclick="document.getElementById('fileInput').click()">
                    üì∏ Selecionar Imagens
                </button>
                <button class="btn-upload btn-folder" onclick="trainBatchImages()">
                    üöÄ Treinar Todas as Imagens
                </button>
            </div>
            
            <div class="preview-grid" id="previewGrid">
                </div>
            
            <div class="batch-training">
                <h4>üéØ Treinamento em Lote</h4>
                <p>Selecione uma letra para associar √†s imagens carregadas:</p>
                
                <select id="batchLetterSelect" style="padding: 8px; border-radius: 5px; margin: 10px 0; width: 100%;">
                    <option value="">-- Selecione uma letra --</option>
                    <option value="A">Letra A</option><option value="B">Letra B</option><option value="C">Letra C</option><option value="D">Letra D</option><option value="E">Letra E</option><option value="F">Letra F</option><option value="G">Letra G</option><option value="H">Letra H</option><option value="I">Letra I</option><option value="J">Letra J</option><option value="K">Letra K</option><option value="L">Letra L</option><option value="M">Letra M</option><option value="N">Letra N</option><option value="O">Letra O</option><option value="P">Letra P</option><option value="Q">Letra Q</option><option value="R">Letra R</option><option value="S">Letra S</option><option value="T">Letra T</option><option value="U">Letra U</option><option value="V">Letra V</option><option value="W">Letra W</option><option value="X">Letra X</option><option value="Y">Letra Y</option><option value="Z">Letra Z</option>
                </select>
                
                <div class="training-progress" id="trainingProgress" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                    </div>
                    <div class="progress-text" id="progressText">0/0 imagens processadas</div>
                </div>
            </div>
        </div>

        <div class="cameras-container">
            <div class="camera-box">
                <h3 class="camera-title">üì∑ Webcam Original</h3>
                <video id="webcam" class="webcam-view" autoplay playsinline></video>
                <div class="detection-info" id="webcamInfo">
                    Clique em "Iniciar C√¢mera"
                </div>
            </div>

            <div class="camera-box">
                <h3 class="camera-title">üñêÔ∏è M√£o Detectada</h3>
                <canvas id="handCanvas" class="hand-canvas"></canvas>
                <div class="detection-info" id="handInfo">
                    Inicie a c√¢mera primeiro
                </div>
            </div>
        </div>

        <div class="controls-section">
            <h3 class="section-title">üéØ Treinamento por Webcam</h3>
            
            <div class="button-grid">
                <button class="btn-webcam" onclick="initWebcam()" id="webcamBtn">üé• Iniciar C√¢mera</button>
                <button class="btn-recognize" onclick="startRecognition()" disabled id="recognizeBtn">üîç Reconhecer</button>
                <button class="btn-stop" onclick="stopRecognition()" disabled id="stopBtn">‚èπÔ∏è Parar Tudo</button>
                <button class="btn-save" onclick="saveModel()" disabled id="saveBtn">üíæ Salvar Modelo</button>
                <button class="btn-load" onclick="loadModel()" id="loadBtn">üìÇ Carregar Modelo</button>
                <button class="btn-clear" onclick="clearModel()" id="clearBtn">üßπ Limpar Tudo</button>
            </div>

            <h4 style="margin: 15px 0 10px 0; color: #2c3e50;">Treinamento por Webcam:</h4>
            <div class="letters-grid">
                <button class="btn-train" onclick="trainLetter('A')" disabled id="trainA">A</button><button class="btn-train" onclick="trainLetter('B')" disabled id="trainB">B</button><button class="btn-train" onclick="trainLetter('C')" disabled id="trainC">C</button><button class="btn-train" onclick="trainLetter('D')" disabled id="trainD">D</button><button class="btn-train" onclick="trainLetter('E')" disabled id="trainE">E</button><button class="btn-train" onclick="trainLetter('F')" disabled id="trainF">F</button><button class="btn-train" onclick="trainLetter('G')" disabled id="trainG">G</button><button class="btn-train" onclick="trainLetter('H')" disabled id="trainH">H</button><button class="btn-train" onclick="trainLetter('I')" disabled id="trainI">I</button><button class="btn-train" onclick="trainLetter('J')" disabled id="trainJ">J</button><button class="btn-train" onclick="trainLetter('K')" disabled id="trainK">K</button><button class="btn-train" onclick="trainLetter('L')" disabled id="trainL">L</button><button class="btn-train" onclick="trainLetter('M')" disabled id="trainM">M</button><button class="btn-train" onclick="trainLetter('N')" disabled id="trainN">N</button><button class="btn-train" onclick="trainLetter('O')" disabled id="trainO">O</button><button class="btn-train" onclick="trainLetter('P')" disabled id="trainP">P</button><button class="btn-train" onclick="trainLetter('Q')" disabled id="trainQ">Q</button><button class="btn-train" onclick="trainLetter('R')" disabled id="trainR">R</button><button class="btn-train" onclick="trainLetter('S')" disabled id="trainS">S</button><button class="btn-train" onclick="trainLetter('T')" disabled id="trainT">T</button><button class="btn-train" onclick="trainLetter('U')" disabled id="trainU">U</button><button class="btn-train" onclick="trainLetter('V')" disabled id="trainV">V</button><button class="btn-train" onclick="trainLetter('W')" disabled id="trainW">W</button><button class="btn-train" onclick="trainLetter('X')" disabled id="trainX">X</button><button class="btn-train" onclick="trainLetter('Y')" disabled id="trainY">Y</button><button class="btn-train" onclick="trainLetter('Z')" disabled id="trainZ">Z</button>
            </div>
        </div>

        <div class="results-section">
            <h3 class="section-title">üìä Resultados em Tempo Real</h3>
            
            <div class="prediction-box">
                <h3 style="margin-bottom: 20px; font-size: 1.5em;">Sinal Reconhecido:</h3>
                
                <div id="resultado">---</div>
                <div class="confidence" id="confianca">Confian√ßa: 0%</div>
                
                <img id="imagemGesto" 
                    style="display: none;" 
                    alt="Gesto em Libras">
            </div>
            
            <div class="status-box">
                <strong>Status do Sistema:</strong> <span id="status">Clique em "Iniciar C√¢mera" para come√ßar</span>
            </div>
            
            <div class="samples-box">
                <strong>üìà Estat√≠sticas de Treino:</strong><br>
                <span id="contadorAmostras">Nenhuma amostra treinada</span>
            </div>
        </div>

        <footer>
            <p>ü§ñ Desenvolvido com TensorFlow.js | Upload + Webcam</p>
        </footer>
    </div>

    <script src="app.js"></script>
</body>
</html>